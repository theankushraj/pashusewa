# 🐾 PashuSewa - Animal Rescue Reporting System

[![Cloudflare Pages](https://img.shields.io/badge/Deployed%20on-Cloudflare%20Pages-orange?style=flat-square&logo=cloudflare)](https://pashusewa.pages.dev)
[![Cloudflare Workers](https://img.shields.io/badge/Backend-Cloudflare%20Workers-blue?style=flat-square&logo=cloudflare)](https://workers.cloudflare.com)
[![License](https://img.shields.io/badge/License-MIT-green?style=flat-square)](LICENSE)

> **Empowering communities to save injured animals through technology**

PashuSewa is a comprehensive web application that enables users to report injured animals and helps NGOs/rescue organizations efficiently manage and respond to these reports. Built with modern web technologies and AI-powered animal detection.

## 🌟 Features

### 🚨 For Users (Animal Reporters)
- **📸 Smart Photo Upload**: AI-powered animal detection automatically identifies species
- **📍 GPS Location**: Automatic location detection with manual refresh option
- **🤖 AI Animal Recognition**: Detects dogs, cats, cows, horses, goats, sheep, birds, and more
- **📝 Auto-Generated Notes**: Automatically fills "Injured [animal_name]" based on photo analysis
- **✅ Instant Confirmation**: Real-time feedback and submission confirmation
- **📱 Mobile Optimized**: Works seamlessly on smartphones and tablets

### 🏢 For NGOs/Rescue Organizations
- **📊 Management Dashboard**: Comprehensive view of all animal reports
- **🎯 Location-Based Filtering**: Find reports within specified radius using GPS
- **📏 Distance Calculation**: Automatic distance calculation from your location
- **🔄 Status Management**: Track reports through Pending → In Progress → Resolved
- **🗺️ Google Maps Integration**: Direct links to report locations
- **📱 Responsive Design**: Full functionality on all devices

### 🤖 AI-Powered Features
- **Multi-Tier Detection System**:
  - Google Vision API integration (ready)
  - Clarifai API integration (ready)
  - Advanced client-side image analysis (always available)
- **Smart Animal Identification**: Color, pattern, and shape analysis
- **Weighted Probability**: Based on real rescue statistics
- **Fallback System**: Always provides results, even offline

## 🏗️ Architecture

### Frontend (Cloudflare Pages)
```
frontend/
├── index.html          # User interface
├── admin.html          # NGO/Admin panel
├── css/
│   └── style.css       # Responsive styling
└── js/
    ├── main.js         # User functionality
    ├── admin.js        # Admin functionality
    └── config.js       # API configuration
```

### Backend (Cloudflare Workers)
```
backend/
├── worker.js           # API endpoints
├── schema.sql          # Database schema
└── wrangler.toml       # Deployment configuration
```

## 🚀 Quick Start

### Prerequisites
- Cloudflare account
- Node.js (for local development)
- Wrangler CLI

### 1. Clone Repository
```bash
git clone https://github.com/yourusername/pashusewa.git
cd pashusewa
```

### 2. Backend Setup (Cloudflare Workers)
```bash
cd backend
npm install -g wrangler

# Login to Cloudflare
wrangler login

# Create D1 database
wrangler d1 create pashusewa

# Update wrangler.toml with your database ID
# Run database migrations
wrangler d1 execute pashusewa --file=schema.sql

# Deploy worker
wrangler deploy
```

### 3. Frontend Setup (Cloudflare Pages)
```bash
cd frontend

# Update js/config.js with your worker URL
# Deploy to Cloudflare Pages (connect GitHub repo)
```

### 4. Configuration
Update `frontend/js/config.js`:
```javascript
const API_URL = "https://your-worker-name.your-subdomain.workers.dev";
```

## 📊 Database Schema

```sql
CREATE TABLE reports (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  image TEXT NOT NULL,              -- Base64 encoded image
  latitude REAL NOT NULL,           -- GPS latitude
  longitude REAL NOT NULL,          -- GPS longitude
  note TEXT,                        -- User notes (auto-generated by AI)
  status TEXT NOT NULL DEFAULT 'Pending',  -- Pending/In Progress/Resolved
  created_at TEXT NOT NULL          -- ISO timestamp
);
```

## 🔧 API Endpoints

### `GET /api/reports`
Fetch all reports (sorted by creation date)

**Response:**
```json
[
  {
    "id": 1,
    "image": "data:image/jpeg;base64,...",
    "latitude": 28.6139,
    "longitude": 77.2090,
    "note": "Injured dog",
    "status": "Pending",
    "created_at": "2025-01-15T10:30:00.000Z"
  }
]
```

### `POST /api/report`
Create new animal report

**Request:**
```json
{
  "image": "data:image/jpeg;base64,...",
  "latitude": 28.6139,
  "longitude": 77.2090,
  "note": "Injured dog"
}
```

### `POST /api/update-status`
Update report status (NGO/Admin only)

**Request:**
```json
{
  "id": 1,
  "status": "In Progress"
}
```

## 🤖 AI Animal Detection

### Supported Animals
- **Domestic**: Dogs, Cats, Rabbits
- **Livestock**: Cows, Horses, Goats, Sheep, Pigs
- **Birds**: Chickens, Various bird species
- **Wildlife**: Deer, Elephants, Tigers, Lions, Bears, Wolves, Foxes, Monkeys
- **Others**: Snakes, Lizards, Turtles, Fish

### Detection Methods
1. **Primary APIs**: Google Vision API, Clarifai API
2. **Client-Side Analysis**: Color distribution, shape analysis, pattern recognition
3. **Smart Fallback**: Weighted probability based on rescue statistics

### Example Detection Output
```javascript
// Input: Photo of injured dog
// Output: "Injured dog" (automatically filled in notes)

// Input: Photo of cow
// Output: "Injured cow"
```

## 🎨 UI/UX Features

### Design System
- **Colors**: Green primary (#4caf50), Orange secondary (#f57c00)
- **Typography**: Poppins font family
- **Layout**: CSS Grid and Flexbox
- **Responsive**: Mobile-first design approach

### Status Color Coding
- 🟠 **Pending**: Orange (#f57c00)
- 🔵 **In Progress**: Blue (#2196f3)
- 🟢 **Resolved**: Green (#4caf50)

## 📱 Mobile Features

- **Camera Integration**: Direct photo capture
- **GPS Access**: High-accuracy location services
- **Touch Optimized**: Large buttons and touch targets
- **Offline Resilience**: Graceful handling of network issues
- **Progressive Web App**: App-like experience

## 🔒 Security & Privacy

- **CORS Configuration**: Restricted to production domains
- **Input Validation**: Prevents malicious data injection
- **Location Privacy**: User consent required for GPS access
- **Error Sanitization**: No sensitive data in error messages
- **Base64 Storage**: Secure image handling

## 🌍 Deployment

### Production URLs
- **Frontend**: `https://pashusewa.pages.dev`
- **Backend**: `https://pashusewa.your-subdomain.workers.dev`

### Environment Configuration
```toml
# wrangler.toml
name = "pashusewa"
main = "worker.js"
compatibility_date = "2024-01-01"

[[d1_databases]]
binding = "DB"
database_name = "pashusewa"
database_id = "your-database-id"
```

## 🤝 Contributing

1. Fork the repository
2. Create feature branch (`git checkout -b feature/amazing-feature`)
3. Commit changes (`git commit -m 'Add amazing feature'`)
4. Push to branch (`git push origin feature/amazing-feature`)
5. Open Pull Request

### Development Guidelines
- Follow existing code style
- Add comments for complex logic
- Test on multiple devices
- Ensure mobile compatibility

## 📈 Performance

- **Frontend**: Static hosting with global CDN
- **Backend**: Serverless with edge computing
- **Database**: SQLite with optimized queries
- **Images**: Base64 encoding with compression
- **Caching**: Browser caching for static assets

## 🐛 Troubleshooting

### Common Issues

**Location not detected:**
- Ensure HTTPS connection
- Grant location permissions
- Try manual refresh

**Image upload fails:**
- Check file size (recommended < 2MB)
- Ensure image format (JPEG, PNG, WebP)
- Verify network connection

**API errors:**
- Check CORS configuration
- Verify worker deployment
- Check database connection

## 📄 License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## 🙏 Acknowledgments

- **Cloudflare**: For providing excellent serverless infrastructure
- **Google Fonts**: For the beautiful Poppins typography
- **Open Source Community**: For inspiration and best practices
- **Animal Rescue Organizations**: For their invaluable feedback

## 📞 Support

- **Issues**: [GitHub Issues](https://github.com/yourusername/pashusewa/issues)
- **Discussions**: [GitHub Discussions](https://github.com/yourusername/pashusewa/discussions)
- **Email**: support@pashusewa.com

---

<div align="center">

**Made with ❤️ for animal welfare**

[🌐 Live Demo](https://pashusewa.pages.dev) • [📖 Documentation](https://github.com/yourusername/pashusewa/wiki) • [🐛 Report Bug](https://github.com/yourusername/pashusewa/issues)

</div>
